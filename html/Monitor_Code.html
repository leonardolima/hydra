<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Monitor_Code</title>
</head>


<body>
<div class="head">
<h1>Theory Monitor_Code</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command">theory</span></span> Monitor_Code
  <span class="keyword2"><span class="keyword">imports</span></span> <span class="quoted">"<a href="../../HOL/HOL-Library/Code_Target_Nat.html">HOL-Library.Code_Target_Nat</a>"</span> <span class="quoted">"<a href="../../AFP/Containers/Containers.html">Containers.Containers</a>"</span> <a href="Monitor.html">Monitor</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">code_printing</span></span>
  <span class="keyword2"><span class="keyword">code_module</span></span> <span class="quoted">"IArray"</span> <span class="main">⇀</span> <span class="main">(</span>OCaml<span class="main">)</span>
<span class="quoted">‹module IArray : sig
  val length' : 'a array -&gt; Z.t
  val sub' : 'a array * Z.t -&gt; 'a
end = struct

let length' xs = Z.of_int (Array.length xs);;

let sub' (xs, i) = Array.get xs (Z.to_int i);;

end›</span> <span class="keyword2"><span class="keyword">for</span></span> <span class="keyword2"><span class="keyword">type_constructor</span></span> iarray <span class="keyword2"><span class="keyword">constant</span></span> <span class="quoted">IArray.length'</span> <span class="quoted">IArray.sub'</span>

<span class="keyword1"><span class="command">code_reserved</span></span> OCaml IArray

<span class="keyword1"><span class="command">code_printing</span></span>
  <span class="keyword2"><span class="keyword">type_constructor</span></span> iarray <span class="main">⇀</span> <span class="main">(</span>OCaml<span class="main">)</span> <span class="quoted">"_ array"</span>
<span class="main">|</span> <span class="keyword2"><span class="keyword">constant</span></span> <span class="quoted">iarray_of_list</span> <span class="main">⇀</span> <span class="main">(</span>OCaml<span class="main">)</span> <span class="quoted">"Array.of'_list"</span>
<span class="main">|</span> <span class="keyword2"><span class="keyword">constant</span></span> <span class="quoted">IArray.list_of</span> <span class="main">⇀</span> <span class="main">(</span>OCaml<span class="main">)</span> <span class="quoted">"Array.to'_list"</span>
<span class="main">|</span> <span class="keyword2"><span class="keyword">constant</span></span> <span class="quoted">IArray.length'</span> <span class="main">⇀</span> <span class="main">(</span>OCaml<span class="main">)</span> <span class="quoted">"IArray.length'"</span>
<span class="main">|</span> <span class="keyword2"><span class="keyword">constant</span></span> <span class="quoted">IArray.sub'</span> <span class="main">⇀</span> <span class="main">(</span>OCaml<span class="main">)</span> <span class="quoted">"IArray.sub'"</span>

<span class="keyword1"><span class="command">lemma</span></span> iarray_list_of_inj<span class="main">:</span> <span class="quoted"><span class="quoted">"IArray.list_of <span class="free">xs</span> <span class="main">=</span> IArray.list_of <span class="free">ys</span> <span class="main">⟹</span> <span class="free">xs</span> <span class="main">=</span> <span class="free">ys</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">xs</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">cases</span> <span class="quoted"><span class="free">ys</span></span><span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">instantiation</span></span> iarray <span class="main">::</span> <span class="main">(</span><span class="quoted">ccompare</span><span class="main">)</span> <span class="quoted">ccompare</span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity"><span class="class_parameter">ccompare_iarray</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span> iarray <span class="main">⇒</span> <span class="tfree">'a</span> iarray <span class="main">⇒</span> order<span class="main">)</span> option"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">ccompare_iarray</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">case</span> ID <span class="keyword1">CCOMPARE</span><span class="main">(</span><span class="tfree">'a</span> list<span class="main">)</span> <span class="keyword1">of</span> None <span class="main">⇒</span> None
  <span class="main">|</span> Some <span class="bound">c</span> <span class="main">⇒</span> Some <span class="main">(</span><span class="main">λ</span><span class="bound">xs</span> <span class="bound">ys</span><span class="main">.</span> <span class="bound">c</span> <span class="main">(</span>IArray.list_of <span class="bound">xs</span><span class="main">)</span> <span class="main">(</span>IArray.list_of <span class="bound">ys</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">instance</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">standard</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">unfold_locales</span>
  <span class="keyword1"><span class="command">using</span></span> comparator.sym<span class="main">[</span><span class="operator">OF</span> ID_ccompare'<span class="main">]</span> comparator.weak_eq<span class="main">[</span><span class="operator">OF</span> ID_ccompare'<span class="main">]</span>
    comparator.trans<span class="main">[</span><span class="operator">OF</span> ID_ccompare'<span class="main">]</span> iarray_list_of_inj
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> ccompare_iarray_def <span class="quasi_keyword">split</span><span class="main"><span class="main">:</span></span> option.splits<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">derive</span></span> <span class="main">(</span>rbt<span class="main">)</span> mapping_impl <span class="quoted">iarray</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">mk_event</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"String.literal list <span class="main">⇒</span> String.literal set"</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">mk_event</span> <span class="main">=</span> set"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">enat_interval</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">⇒</span> <span class="main">_</span> <span class="main">⇒</span> enat ℐ"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">enat_interval</span> <span class="main">=</span> interval"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">sub_vydra</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">⇒</span> <span class="main">_</span> <span class="main">⇒</span> <span class="main">_</span> <span class="main">⇒</span> <span class="main">_</span> <span class="main">⇒</span> <span class="main">(</span>String.literal<span class="main">,</span> enat<span class="main">,</span> <span class="tfree">'e</span><span class="main">)</span> vydra"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">sub_vydra</span> <span class="main">=</span> sub"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">run_vydra</span> <span class="main">::</span> <span class="quoted"><span class="quoted">" <span class="main">_</span> <span class="main">⇒</span> <span class="main">_</span> <span class="main">⇒</span> <span class="main">(</span>String.literal<span class="main">,</span> enat<span class="main">,</span> <span class="tfree">'e</span><span class="main">)</span> vydra <span class="main">⇒</span> <span class="main">_</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">run_vydra</span> <span class="main">=</span> run"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">msize_fmla_vydra</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>String.literal<span class="main">,</span> enat<span class="main">)</span> formula <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">msize_fmla_vydra</span> <span class="main">=</span> msize_fmla"</span></span>

<span class="keyword1"><span class="command">export_code</span></span> <span class="quoted"><span class="quoted">sub_vydra</span></span> <span class="quoted"><span class="quoted">run_vydra</span></span> <span class="quoted"><span class="quoted">msize_fmla_vydra</span></span>
  <span class="quoted"><span class="quoted">Bool</span></span> <span class="quoted"><span class="quoted">enat</span></span> <span class="quoted"><span class="quoted">enat_interval</span></span> <span class="quoted"><span class="quoted">nat_of_integer</span></span> <span class="quoted"><span class="quoted">integer_of_nat</span></span> <span class="quoted"><span class="quoted">mk_event</span></span>
  <span class="keyword2"><span class="keyword">in</span></span> OCaml <span class="keyword2"><span class="keyword">module_name</span></span> VYDRA <span class="keyword2"><span class="keyword">file_prefix</span></span> <span class="quoted">"verified"</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ereal_interval</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">⇒</span> <span class="main">_</span> <span class="main">⇒</span> ereal ℐ"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">ereal_interval</span> <span class="main">=</span> interval"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">sub_real_vydra</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">⇒</span> <span class="main">_</span> <span class="main">⇒</span> <span class="main">_</span> <span class="main">⇒</span> <span class="main">_</span> <span class="main">⇒</span> <span class="main">(</span>String.literal<span class="main">,</span> ereal<span class="main">,</span> <span class="tfree">'e</span><span class="main">)</span> vydra"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">sub_real_vydra</span> <span class="main">=</span> sub"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">run_real_vydra</span> <span class="main">::</span> <span class="quoted"><span class="quoted">" <span class="main">_</span> <span class="main">⇒</span> <span class="main">_</span> <span class="main">⇒</span> <span class="main">(</span>String.literal<span class="main">,</span> ereal<span class="main">,</span> <span class="tfree">'e</span><span class="main">)</span> vydra <span class="main">⇒</span> <span class="main">_</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">run_real_vydra</span> <span class="main">=</span> run"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">msize_fmla_real_vydra</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>String.literal<span class="main">,</span> ereal<span class="main">)</span> formula <span class="main">⇒</span> real"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">msize_fmla_real_vydra</span> <span class="main">=</span> msize_fmla"</span></span>

<span class="keyword2"><span class="keyword">end</span></span></pre>
</body>

</html>